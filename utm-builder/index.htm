<!DOCTYPE html>
<html>
  <head>
    <!--Import Google Icon Font-->
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-alpha.3/css/materialize.min.css">
    <title>UTM Builder</title>
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style type="text/css">
      #utm-to-share{
        font-size: 0.9em;
      }

      .general.input-field label{
        font-size: 1.5em;
      }

      .help:hover{
        cursor:pointer;
      }

      /* label color */
       .input-field label {
         color: #000;
       }
       /* label focus color */
       .input-field input[type=text]:focus + label {
         color: #000;
         border-bottom : #f57f17;
       }
       /* label underline focus color */
       .input-field input[type=text]:focus {
         border-bottom: 1px solid #f57f17;
         box-shadow: 0 1px 0 0 #f57f17;
       }
       /* valid color */
       .input-field input[type=text].valid {
         border-bottom: 1px solid #000;
         box-shadow: 0 1px 0 0 #000;
       }
       /* invalid color */
       .input-field input[type=text].invalid {
         border-bottom: 1px solid red;
         box-shadow: 0 1px 0 0 red;
       }
       /* icon prefix focus color */
       .input-field .prefix.active {
         color: #000;
       }

       .dropdown-content,
       .select-dropdown{
        overflow: scroll;
       }

       
    </style>
  </head>

  <body>
    <!-- Content goes here-->
      <div class="container">
        <div class="row card grey lighten-5 yellow-text text-darken-4">
          <div class="col s12">
            <h1>Générer une url suivie</h1>
          </div>
          <div class="row">
            <div class="col s12 grey-text text-darken-4">
            <strong>❗️Rappels importants❗️</strong><br>
            <ul>
              <li>Toutes les informations doivent être saisies <strong>sans majuscule, sans accent, sans espace (utiliser un tiret : -)</strong></li>
              <li>Seuls les  <strong>4 premiers champs sont obligatoires</strong></li>
              <li>Penses à <strong>tester systématiquement le lien final</strong></li>
            </ul>
            <p><em>Si le lien est diffusé de façon visible (Ex: "Rendez-vous sur unepetitemousse.fr?utm_source=xxx") => utilisez bitly pour le raccourcir et le brander. Sinon, s'il est caché derrière un texte d'ancrage, utilisez le tel-quel.</em></p>
            <p class="center-align"><strong class="orange-text text-darken-4">Vous ne trouvez pas votre campagne, source ou support ? Slackez-moi !</strong></p>
          </div>
          </div>
        </div>
      
        <div class="row card">
          <p>&nbsp;</p>
          <form class="col m7 general" name="general">
                <div class="row">
                  <div class="input-field col s12">
                    <input placeholder="https://unepetitemousse.fr" id="base-url" type="url" class="validate autocomplete-base-url" >
                    <label for="base-url" class="yellow-text text-darken-4">URL de Destination <i class="material-icons help" id="help-base-url">live_help</i></label>
                  </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                      <select class="yellow-text text-darken-4" id="utm-campagne" required>
                        <option class="yellow-text text-darken-4" value="" disabled selected>Choisissez votre campagne</option>
                        <option class="yellow-text text-darken-4" value="avis">avis</option>
                        <option class="yellow-text text-darken-4" value="blog">blog</option>
                        <option class="yellow-text text-darken-4" value="boutique">boutique</option>
                        <option class="yellow-text text-darken-4" value="box">box</option>
                        <option class="yellow-text text-darken-4" value="brasserie">brasserie</option>
                        <option class="yellow-text text-darken-4" value="brewdog-mix">brewdog-mix</option>
                        <option class="yellow-text text-darken-4" value="cagnotte">cagnotte</option>
                        <option class="yellow-text text-darken-4" value="calendrier-apres">calendrier-apres</option>
                        <option class="yellow-text text-darken-4" value="calendrier-avent">calendrier-avent</option>
                        <option class="yellow-text text-darken-4" value="calendrier-fdp">calendrier-fdp</option>
                        <option class="yellow-text text-darken-4" value="calendrier-fdp">calendrier-sexy</option>
                        <option class="yellow-text text-darken-4" value="carte-cadeau">carte-cadeau</option>
                        <option class="yellow-text text-darken-4" value="clemity-beer">clemity-beer</option>
                        <option class="yellow-text text-darken-4" value="franglaise">franglaise</option>
                        <option class="yellow-text text-darken-4" value="gazette">gazette</option>
                        <option class="yellow-text text-darken-4" value="guide-cadeau">guide-cadeau</option>
                        <option class="yellow-text text-darken-4" value="kit-brassage">kit-brassage</option>
                        <option class="yellow-text text-darken-4" value="kit-houblon">kit-houblon</option>
                        <option class="yellow-text text-darken-4" value="mousse-a-4">mousse-a-4</option>
                        <option class="yellow-text text-darken-4" value="mousse-a-vie">mousse-a-vie</option>
                        <option class="yellow-text text-darken-4" value="parrainage">parrainage</option>
                        <option class="yellow-text text-darken-4" value="vente-privee">vente-privee</option>
                      </select>
                      <label class="yellow-text text-darken-4">Nom de la campagne <i class="material-icons help" id="help-utm-campagne">live_help</i></label>
                    </div>
                </div>
                <div class="row">
                  <div class="input-field col s12">
                    <select class="yellow-text text-darken-4" id="utm-source" required>
                      <option class="yellow-text text-darken-4" value="" disabled selected>Choisissez la source</option>
                      <option class="yellow-text text-darken-4" value="backend">backend</option>
                      <option class="yellow-text text-darken-4" value="bing">bing</option>
                      <option class="yellow-text text-darken-4" value="blog">blog</option>
                      <option class="yellow-text text-darken-4" value="facebook">facebook</option>
                      <option class="yellow-text text-darken-4" value="google">google</option>
                      <option class="yellow-text text-darken-4" value="happybeertime.com">happybeertime.com</option>
                      <option class="yellow-text text-darken-4" value="instagram">instagram</option>
                      <option class="yellow-text text-darken-4" value="laboxdumois.fr">laboxdumois.fr</option>
                      <option class="yellow-text text-darken-4" value="leetchi.com">leetchi.com</option>
                      <option class="yellow-text text-darken-4" value="leparrainage.fr">leparrainage.fr</option>
                      <option class="yellow-text text-darken-4" value="lepotcommun.fr">lepotcommun.fr</option>
                      <option class="yellow-text text-darken-4" value="lesmondaines.com">lesmondaines.com</option>
                      <option class="yellow-text text-darken-4" value="lesnouveauxfromagers.fr">lesnouveauxfromagers.fr</option>
                      <option class="yellow-text text-darken-4" value="lexpress.fr">lexpress.fr</option>
                      <option class="yellow-text text-darken-4" value="linkedin">linkedin</option>
                      <option class="yellow-text text-darken-4" value="lokan.fr">lokan.fr</option>
                      <option class="yellow-text text-darken-4" value="ma-reduc.com">ma-reduc.com</option>
                      <option class="yellow-text text-darken-4" value="maddyness.com">maddyness.com</option>
                      <option class="yellow-text text-darken-4" value="madmoizelle.com">madmoizelle.com</option>
                      <option class="yellow-text text-darken-4" value="mautic">mautic</option>
                      <option class="yellow-text text-darken-4" value="monbon.fr">monbon.fr</option>
                      <option class="yellow-text text-darken-4" value="noeldelafrenchtech.fr">noeldelafrenchtech.fr</option>
                      <option class="yellow-text text-darken-4" value="one-signal">one-signal</option>
                      <option class="yellow-text text-darken-4" value="presse">presse</option>
                      <option class="yellow-text text-darken-4" value="print">print</option>
                      <option class="yellow-text text-darken-4" value="site">site</option>
                      <option class="yellow-text text-darken-4" value="squadata">squadata</option>
                      <option class="yellow-text text-darken-4" value="topito.com">topito.com</option>
                      <option class="yellow-text text-darken-4" value="touteslesbox.fr">touteslesbox.fr</option>
                      <option class="yellow-text text-darken-4" value="trucsdemec.fr">trucsdemec.fr</option>
                      <option class="yellow-text text-darken-4" value="twitter">twitter</option>
                      <option class="yellow-text text-darken-4" value="typeform">typeform</option>
                      <option class="yellow-text text-darken-4" value="uncafemonblocnote.fr">uncafemonblocnote.fr</option>
                      <option class="yellow-text text-darken-4" value="youtube">youtube</option>
                      <option class="yellow-text text-darken-4" value="print">print</option>
                      <option class="yellow-text text-darken-4" value="messenger">messenger</option>
                    </select>
                    <label class="yellow-text text-darken-4">Source de la campagne <i class="material-icons help" id="help-utm-source">live_help</i></label>
                  </div>

                </div>
                <div class="row">
                  <div class="input-field col s12">
                    <select class="yellow-text text-darken-4" id="utm-support" required>
                      <option class="yellow-text text-darken-4" value="" disabled selected>Choisissez le support</option>
                      <option class="yellow-text text-darken-4" value="10-10">10-10</option>
                      <option class="yellow-text text-darken-4" value="article">article</option>
                      <option class="yellow-text text-darken-4" value="banner">banner</option>
                      <option class="yellow-text text-darken-4" value="bio">bio</option>
                      <option class="yellow-text text-darken-4" value="broadcast">broadcast</option>
                      <option class="yellow-text text-darken-4" value="chatbot">chatbot</option>
                      <option class="yellow-text text-darken-4" value="cpc">cpc</option>
                      <option class="yellow-text text-darken-4" value="cta">cta</option>
                      <option class="yellow-text text-darken-4" value="dark-post">dark-post</option>
                      <option class="yellow-text text-darken-4" value="email">email</option>
                      <option class="yellow-text text-darken-4" value="newsletter">newsletter</option>
                      <option class="yellow-text text-darken-4" value="plaque-protection-calendrier">plaque-protection-calendrier</option>
                      <option class="yellow-text text-darken-4" value="post">post</option>
                      <option class="yellow-text text-darken-4" value="push">push</option>
                    </select>
                    <label class="yellow-text text-darken-4">Support de la campagne <i class="material-icons help" id="help-utm-support">live_help</i></label>
                  </div>

                </div>
                <div class="row">
                  <div class="input-field col s12">
                    <input placeholder="bonus-septembre-2018,french-days-2018," id="utm-contenu" type="text" class="validate">
                    <label class="yellow-text text-darken-4" for="utm-contenu">Contenu de la campagne <i class="material-icons help" id="help-utm-contenu">live_help</i></label>
                  </div>
                </div>
                <div class="row">
                  <div class="input-field col s12">
                    <input placeholder="janvier-2018,audience-acheteurs-box,audience-grenoblois,article,membres-unepetitemousse" id="utm-terme" type="text" class="validate">
                    <label class="yellow-text text-darken-4" for="utm-terme">Terme de la campagne <i class="material-icons help" id="help-utm-terme">live_help</i></label>
                  </div>
                </div>

                <div class="row">
                  <div class="input-field col s12">
                  <p>
                    <label>
                      <input type="checkbox" id="do-analyze" class="filled-in" checked/>
                      <span>Je veux que cette campagne soit <strong>analysée</strong></span>
                    </label>
                  </p>
                  <div class="row">
                    <div class="input-field col s6 offset-s1 div-days-to-analysis">
                      <input placeholder="1,3,5,10,30,..." id="days-to-analysis" type="number" value="5" class="validate">
                      <label class="yellow-text text-darken-4" for="days-to-analysis">Dans combien de jours ?</label>
                    </div>
                  </div>
                  </div>
                </div>
                <!--
                <div class="row">
                  <div class="input-field col s12">
                  <p>
                    <label>
                      <input type="checkbox" id="do-optimize" class="filled-in" />
                      <span>Je veux que cette campagne soit <strong>optimisée</strong></span>
                    </label>
                  </p>
                  <div class="row">
                    <div class="input-field col s5 offset-s1 div-days-to-optimize">
                      <input placeholder="1,3,5,10,30,..." id="days-to-optimize" type="number" class="validate">
                      <label class="yellow-text text-darken-4" for="days-to-optimize">Dans combien de jours ?</label>
                    </div>
                    <div class="input-field col s6 div-days-to-optimize">
                      <input placeholder="Audience, placement, titre..." id="what-to-optimize" type="text" class="validate">
                      <label class="yellow-text text-darken-4" for="what-to-optimize">Que souhaites-tu optimiser ?</label>
                    </div>
                  </div>
                  </div>
                </div>
                -->
                <button class="btn waves-effect yellow darken-4 waves-light" onclick="getFormElements();">Obtenir mon lien
                    <i class="material-icons left">link</i>
                </button>
                <p>&nbsp;</p>
              </form>
          <div class="col m5 grey-lighten-4">
            <strong>Un doute sur l'une des valeur à renseigner ?</strong>
            <!--Start answer for base-url-->
            <div class="answer card" id="answer-base-url">
              <div class="card-content">
                L'<span class="yellow-text text-darken-4">URL de destination</span> correspond à l'url de la page sur laquelle tu souhaites diriger les visiteurs. <br><br>
                Par exemple : <em>https://unepetitemousse.fr/</em> ou <em>https://unepetitemousse.fr/cadeau-biere</em>
                <br><br>
                Si tu as besoin d'ajouter des paramètres (?duree=3, ?coffret=mois,...), ajoutes-les dès maintenant !
              </div>
              <div class="card-action">
                <button class="btn btn-flat waves-effect waves-green" id="close-answer-base-url">Compris !</button>  
              </div>
            </div>
            <!--End answer for base-url-->
            <!--Start answer for utm-campagne-->
            <div class="answer card" id="answer-utm-campagne">
              <div class="card-content">
                Le<span class="yellow-text text-darken-4"> nom de la campagne</span> correspond à <strong>l'objectif</strong> poursuivit par la campagne. C'est donc le niveau le plus haut et le plus générique possible.<br><br>
                Par exemple : <em>box</em> ou <em>calendrier-avent</em> ou <em>boutique</em> ou encore <em>brasserie</em>
                <br><br>
                Si tu as un doute : demandes-moi :)
              </div>
              <div class="card-action">
                <button class="btn btn-flat waves-effect waves-orange" id="close-answer-utm-campagne">Compris !</button>  
              </div>
            </div>
            <!--End answer for utm-campagne-->
            <!--Start answer for utm-source-->
            <div class="answer card" id="answer-utm-source">
              <div class="card-content">
                La<span class="yellow-text text-darken-4"> source de la campagne</span> correspond à la <strong>provenance de la campagne</strong>. En d'autre terme elle correspond à "l'endroit" où tu vas déposer ton lien. Il peut s'agir du nom du site sur lequel le lien sera diffusé <br><br>
                Par exemple : <em>mon-super-blog</em>,<em>facebook</em>,<em>google</em>,<em>backend</em> ou encore <em>mautic</em>
                <br><br>
                Si tu as un doute : demandes-moi :)
              </div>
              <div class="card-action">
                <button class="btn btn-flat waves-effect waves-green" id="close-answer-utm-source">Compris !</button>  
              </div>
            </div>
            <!--End answer for utm-source-->
            <!--Start answer for utm-support-->
            <div class="answer card" id="answer-utm-support">
              <div class="card-content">
                Le<span class="yellow-text text-darken-4"> support de la campagne</span> correspond au <strong>moyen par lequel le lien est communiqué</strong> sur la <em>source</em> choisie.<br><br>
                Par exemple : <em>email</em>,<em>post</em>,<em>dark-post</em>,<em>cpc</em> ou encore <em>article</em>.
                <br><br>
                Si tu as un doute : demandes-moi :)
              </div>
              <div class="card-action">
                <button class="btn btn-flat waves-effect waves-green" id="close-answer-utm-support">Compris !</button>  
              </div>
            </div>
            <!--End answer for utm-support-->
           <!--Start answer for utm-contenu-->
           <div class="answer card" id="answer-utm-contenu">
             <div class="card-content">
               Le<span class="yellow-text text-darken-4"> contenu de la campagne</span> permet d'<strong>identifier plus précisément le message qui a été communiqué avec le lien</strong>. On s'en sert par exemple pour préciser la raison pour laquelle on contact un client par email ou pour préciser le contenu d'un post facebook. C'est un élément facultatif.<br><br>
               Par exemple : <em>complement-boutique-octobre-2018</em>,<em>concours-x-y</em>,<em>french-days-2018</em>,<em>barrel-aged-day</em>.
               <br><br>
               Si tu as un doute : demandes-moi :)
             </div>
             <div class="card-action">
               <button class="btn btn-flat waves-effect waves-green" id="close-answer-utm-contenu">Compris !</button>  
             </div>
           </div>
           <!--End answer for utm-contenu-->
            <!--Start answer for utm-terme-->
            <div class="answer card" id="answer-utm-terme">
              <div class="card-content">
                Le<span class="yellow-text text-darken-4"> terme de la campange</span> permet de <strong>différencier les éventuelles variations de la campagne</strong>. On s'en sert par exemple pour préciser l'audience ciblée, le format de publicité ou d'image utilisé, le mot-clé ciblé, le mois concerné... C'est un élément facultatif.<br><br>
                Par exemple : <em>janvier-2018</em>,<em>audience-acheteurs-box</em>,<em>audience-grenoblois</em>,<em>cpc</em>...
                <br><br>
                Si tu as un doute : demandes-moi :)
              </div>
              <div class="card-action">
                <button class="btn btn-flat waves-effect waves-green" id="close-answer-utm-terme">Compris !</button>  
              </div>
            </div>
            <!--End answer for utm-terme-->

            <p id="help-text"><em>Clique sur le point d'interrogation à côté de l'item en question pour afficher l'aide ici ;)</em></p>
          </div>
          <p>&nbsp;</p>
        </div>
        <div class="row card">
          <div class="col s12">
            <p><em>Ajouter des paramètres à un lien permet de modifier certaines informations de la page de destination ou dans certains cas, de simplement passer des informations à Google Analytics sur la provenance de l'utilisateur qui a cliqué sur le lien en question. On ajoute un paramètre à une URL en indiquant son nom (ex: "selection"), immédiatement précédé par un "?" (indiquant au navigateur que les élements suivants de l'url sont des parametres personalisés) ou un "&" si le "?" a déjà été indiqué. ON indique en suite la valeur que l'on souhaite donner au parametre ("=bieres-du-monde). Dans tous les cas, le signe "?" ne doit apparaitre qu'une seule fois dans le lien. Pour des soucis de formalisme, on privilégie les caractères minuscules, sans accents, sans caractères spécial,n en remplacant les espaces par des "-"</em></p>
          </div>
        </div>
        <div id="urlModal" class="modal">
            <div class="modal-content">
              <h4>URL à utiliser</h4>
              <p>Voici l'URL à utiliser pour ta campagne :</p>
              <div class="flow-text"><strong id="utm-to-share"></strong></div>
              <p id="success-feedback" class="alert-success"><em class="green-text">C'est good, l'URL est bien copiée dans ton presse-papier :)</em></p>
            </div>
            
            <div class="modal-footer">
              <a href="#!" id="test-url" class="modal-action modal-close waves-effect waves-green btn green lighten-1">Tester</a>
              <button class="btn btnToCopy yellow darken-4 text-white" data-clipboard-target="#utm-to-share" style="margin-left: 5px;">Copier</button>
              <a href="http://bitly.com" target="_blank" class="waves-effect waves-green btn yellow darken-1">Bitlyser</a>
            </div>
            <div id="gif-wrap"></div>
          </div>
      </div>
    <!-- End of content-->
    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-alpha.3/js/materialize.min.js"></script>
    <script type="text/javascript" src="https://rawgit.com/nicodeforge/clipboard.js/master/dist/clipboard.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){
          $('select').select();
          //$('select').formSelect();
          $('.modal').modal();
          $('#success-feedback').hide();
          $('.answer').hide();
          $('.div-days-to-optimize').hide();
          $("#do-analyze").change(function() {
             $('.div-days-to-analysis').toggle();
          });
          $("#do-optimize").change(function() {
             $('.div-days-to-optimize').toggle();
          });

        });

      function postDataToWebhook(data){
            //get the values needed from the passed in json object
            var baseUrl=data.baseUrl,
               utmCampagne=data.utmCampagne,
               utmSource=data.utmSource,
               utmSupport=data.utmSupport,
               utmContenu=data.utmContenu,
               utmTerme=data.utmTerme,
               createdAt=data.createdAt,
               analysisIn=data.analysisIn,
               analysedAccount=data.analysedAccount,
               urlType=data.urlType,
               formatedAnalysisDate = data.formatedAnalysisDate,
               formatedOptimizeDate = data.formatedOptimizeDate,
               whatToOptimize = data.whatToOptimize;

            //url to your webhook
            var webHookUrl="https://hooks.zapier.com/hooks/catch/1160774/8cqrmx/";
            
            //https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest
            var oReq = new XMLHttpRequest();
            var myJSONStr = payload={
                "baseUrl" : baseUrl,
               "utmCampagne" : utmCampagne,
               "utmSource" : utmSource,
               "utmSupport" : utmSupport,
               "utmContenu" : utmContenu,
               "utmTerme" : utmTerme,
               "createdAt" : moment().format("MMMM Do YYYY"),
               "analysisIn" : analysisIn,
               "analysedAccount" : analysedAccount,
               "urlType" : urlType,
               "formatedAnalysisDate" : formatedAnalysisDate,
               "formatedOptimizeDate" : formatedOptimizeDate,
               "whatToOptimize" : whatToOptimize
                };
              
            //register method called after data has been sent method is executed
              oReq.addEventListener("load", reqListener);
              oReq.open("POST", webHookUrl,true);
              oReq.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
              oReq.send(JSON.stringify(myJSONStr));
            }
            //callback method after webhook is executed
            function reqListener () {
              console.log(this.responseText);
            }

      function getFormElements(){ 
        event.preventDefault(); // Empêche le rechargement de la page et l'effacement des champs du formulaire après le clic du bouton Submit

        //Récupère tous les champs du formulaire et les stocks dans des variables
        
        var baseUrl = document.forms["general"].elements["base-url"].value, 
            utmCampagne = document.forms["general"].elements["utm-campagne"].value, 
            utmSource = document.forms["general"].elements["utm-source"].value,
            utmSupport = document.forms["general"].elements["utm-support"].value,
            utmContenu = document.forms["general"].elements["utm-contenu"].value,
            utmTerme = document.forms["general"].elements["utm-terme"].value,
            createdAt = moment(),
            analysisIn = document.forms["general"].elements["days-to-analysis"].value,
            analysisDate = new Date(), 
            //optimizeIn = document.forms["general"].elements["days-to-optimize"].value,
            //optimizeDate = new Date(), 
            //whatToOptimize = document.forms["general"].elements["what-to-optimize"].value,
            analysedAccount = "inconnu",
            urlType = "0";

            //Traitement du temps d'analyse

           //var formatedAnalysisDate = moment().add(analysisIn, 'days').format();
            
            //Traitement du temps d'optimisation

            // var formatedOptimizeDate = moment().add(optimizeIn, 'days').format();
                

            //Vérifier si des paramètres ont été ajoutés à base-url
        var checkParam = "?",
            hasParam = baseUrl.includes(checkParam); //Renvoi 1 si param ajouté, 0 sinon

            //Vérifier les valeurs utmContenu & utmTerme qui ne sont pas mandatory
            if (utmContenu == '' && utmTerme == '') {
            urlType = "1";
            } else{
              if (utmContenu == '') {
                urlType="2";
              }else{
                if (utmTerme == '') {
                  urlType="3";
                }else{
                  urlType="4";
                }
              }
            }


            //Selon le type d'URL et l'ajout de parametres de base, on assemble l'url finale
            if (hasParam === false) {
              switch (urlType){
                case "1":
                var sharableUrl = baseUrl+"?utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne;
                break;
                case "2":
                var sharableUrl = baseUrl+"?utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_term="+utmTerme;
                break;
                case "3":
                var sharableUrl = baseUrl+"?utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_content="+utmContenu;
                break;
                case "4":
                var sharableUrl = baseUrl+"?utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_content="+utmContenu+"&utm_term="+utmTerme;
                break;
                default :
                var sharableUrl = baseUrl+"?utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne;
              }
            } else{

            if (hasParam === true) {
              switch (urlType){
                case "1":
                var sharableUrl = baseUrl+"&utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne;
                break;
                case "2":
                var sharableUrl = baseUrl+"&utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_term="+utmTerme;
                break;
                case "3":
                var sharableUrl = baseUrl+"&utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_content="+utmContenu;
                break;
                case "4":
                var sharableUrl = baseUrl+"&utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_content="+utmContenu+"&utm_term="+utmTerme;
                break;
                default :
                var sharableUrl = baseUrl+"&utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne;
              }
            }

            }
        

        document.getElementById('utm-to-share').innerHTML = sharableUrl;
        
        $('#urlModal').modal('open');

        // On récupère le nom du compte à analyser
        if (baseUrl.includes("unepetitemousse")) {
          
          analysedAccount = "Une Petite Mousse";

        } else{
          if (baseUrl.includes("laboxfromage")) {
            
            analysedAccount = "La Box Fromage"
          }
        }

        data = {
          "baseUrl" : baseUrl,
          "utmCampagne" : utmCampagne,
          "utmSource" : utmSource,
          "utmSupport" : utmSupport,
          "utmContenu" : utmContenu,
          "utmTerme" : utmTerme,
          "createdAt" : createdAt,
          "analysisIn" : analysisIn,
          "urlType" : urlType,
          "analysedAccount" : analysedAccount,
          "formatedAnalysisDate" : formatedAnalysisDate,
          "formatedOptimizeDate" : formatedOptimizeDate,
          "whatToOptimize" : whatToOptimize
        }

      

        postDataToWebhook(data);

      }

      //Start clipboard plugin init
        var clipboard = new Clipboard('.btnToCopy');
        clipboard.on('success', function(e) {
            $("#success-feedback").show();
            e.clearSelection();
        });
        //End clipboard plugin init


        //Helpers
        $('#help-base-url').click(function(){
          $('.answer').hide();
          $('#answer-base-url').show();
        });
        $('#help-utm-campagne').click(function(){
          $('.answer').hide();
          $('#answer-utm-campagne').show();
        });
        $('#help-utm-source').click(function(){
          $('.answer').hide();
          $('#answer-utm-source').show();
        });
        $('#help-utm-support').click(function(){
          $('.answer').hide();
          $('#answer-utm-support').show();
        });
        $('#help-utm-contenu').click(function(){
          $('.answer').hide();
          $('#answer-utm-contenu').show();
        });
        $('#help-utm-terme').click(function(){
          $('.answer').hide();
          $('#answer-utm-terme').show();
        });
        $('#close-answer-base-url').click(function(e){
          e.preventDefault();
          $('#answer-base-url').hide();
        });
        $('#close-answer-utm-campagne').click(function(e){
          e.preventDefault();
          $('#answer-utm-campagne').hide();
        });
        $('#close-answer-utm-source').click(function(e){
          e.preventDefault();
          $('#answer-utm-source').hide();
        });
        $('#close-answer-utm-support').click(function(e){
          e.preventDefault();
          $('#answer-utm-support').hide();
        });
        $('#close-answer-utm-terme').click(function(e){
          e.preventDefault();
          $('#answer-utm-terme').hide();
        });
        $('#close-answer-utm-contenu').click(function(e){
          e.preventDefault();
          $('#answer-utm-contenu').hide();
        });

      //Autocomplete Destination URL
      $(document).ready(function(){
          $('autocomplete-base-url').autocomplete({
            data: {
              "https://unepetitemousse.fr/": null,
              "https://unepetitemousse.fr/cadeau-biere/": null,
              "https://unepetitemousse.fr/box/abonnement": null
            },
          });
        });
        
        //Tester l'URL
        $('#test-url').click(function(){
          window.open(encodeURI(document.getElementById('utm-to-share').innerText),'_blank');
        });
        

    </script>
  </body>
</html>