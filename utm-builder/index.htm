<!DOCTYPE html>
<html>
  <script>
    var utm_campaign_options = [
      "avis",
      "blog",
      "boutique",
      "box",
      "brasserie",
      "brewdog-mix",
      "cagnotte",
      "calendrier-apres",
      "calendrier-avent",
      "calendrier-fdp",
      "calendrier-sexy",
      "carte-cadeau",
      "clemity-beer",
      "franglaise",
      "galette-rois",
      "gazette",
      "guide-cadeau",
      "hoppy-friday",
      "kit-brassage",
      "kit-houblon",
      "mousse-a-4",
      "mousse-a-vie",
      "parrainage",
      "roulette",
      "sexy-valentine",
      "vente-privee"
    ];

    var utm_source_options = [
      "backend",
      "bing",
      "blog",
      "facebook",
      "google",
      "happybeertime.com",
      "instagram",
      "laboxdumois.fr",
      "leetchi.com",
      "leparrainage.fr",
      "lepotcommun.fr",
      "lesmondaines.com",
      "lesnouveauxfromagers.fr",
      "lexpress.fr",
      "linkedin",
      "lokan.fr",
      "ma-reduc.com",
      "maddyness.com",
      "madmoizelle.com",
      "mautic",
      "monbon.fr",
      "noeldelafrenchtech.fr",
      "one-signal",
      "presse",
      "print",
      "site",
      "squadata",
      "topito.com",
      "touteslesbox.fr",
      "trucsdemec.fr",
      "twitter",
      "typeform",
      "uncafemonblocnote.fr",
      "youtube",
      "print",
      "messenger",
      "webgains"
    ];
    var utm_support_options = [
      "10-10",
      "article",
      "banner",
      "bio",
      "broadcast",
      "chatbot",
      "cpc",
      "cta",
      "dark-post",
      "email",
      "form",
      "newsletter",
      "plaque-protection-calendrier",
      "post",
      "push",
      "story"
    ];

  </script>
  <head>
    <!--Import Google Icon Font-->
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-alpha.3/css/materialize.min.css">
    <title>UTM Builder</title>
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style type="text/css">
      #utm-to-share{
        font-size: 0.9em;
      }

      .general.input-field label{
        font-size: 1.5em;
      }

      .help:hover{
        cursor:pointer;
      }

      /* label color */
       .input-field label {
         color: #000;
       }
       /* label focus color */
       .input-field input[type=text]:focus + label {
         color: #000;
         border-bottom : #f57f17;
       }
       /* label underline focus color */
       .input-field input[type=text]:focus {
         border-bottom: 1px solid #f57f17;
         box-shadow: 0 1px 0 0 #f57f17;
       }
       /* valid color */
       .input-field input[type=text].valid {
         border-bottom: 1px solid #000;
         box-shadow: 0 1px 0 0 #000;
       }
       /* invalid color */
       .input-field input[type=text].invalid {
         border-bottom: 1px solid red;
         box-shadow: 0 1px 0 0 red;
       }
       /* icon prefix focus color */
       .input-field .prefix.active {
         color: #000;
       }

       .dropdown-content,
       .select-dropdown{
        overflow: scroll;
       }

       
    </style>

    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    
    
  </head>

  <body>
    <!-- Content goes here-->
      <div class="container">
        <div class="row card grey lighten-5 yellow-text text-darken-4">
          <div class="col s12">
            <h1>Générer une url suivie</h1>
          </div>
          <div class="row">
            <div class="col s12 grey-text text-darken-4">
            <strong>❗️Rappels importants❗️</strong><br>
            <ul>
              <li>Toutes les informations doivent être saisies <strong>sans majuscule, sans accent, sans espace (utiliser un tiret : -)</strong></li>
              <li>Seuls les  <strong>4 premiers champs sont obligatoires</strong></li>
              <li>Penses à <strong>tester systématiquement le lien final</strong></li>
            </ul>
            <p><em>Si le lien est diffusé de façon visible (Ex: "Rendez-vous sur unepetitemousse.fr?utm_source=xxx") => utilisez bitly pour le raccourcir et le brander. Sinon, s'il est caché derrière un texte d'ancrage, utilisez le tel-quel.</em></p>
            <p class="center-align"><strong class="orange-text text-darken-4">Vous ne trouvez pas votre campagne, source ou support ? Slackez-moi !</strong></p>
          </div>
          </div>
        </div>
      
        <div class="row card">
          <p>&nbsp;</p>
          <form class="col m7 general" name="general">
                <div class="row">
                  <div class="col s12">
                    <label for="base-url" class="yellow-text text-darken-4">URL de Destination <i class="material-icons help" id="help-base-url">live_help</i>
                    <select class="searchable-select select2 yellow-text text-darken-4" id="base-url" style="width:75%;display: block;" required>
                      <option class="yellow-text text-darken-4" value="" disabled selected>URL de destination</option>
                      <option class="yellow-text text-darken-4" value="https://unepetitemousse.fr">https://unepetitemousse.fr</option>
                      <option class="yellow-text text-darken-4" value="https://laboxfromage.fr">https://laboxfromage.fr</option>
                      <option class="yellow-text text-darken-4" value="https://biere.unepetitemousse.fr">https://biere.unepetitemousse.fr</option>
                      <option class="yellow-text text-darken-4" value="https://boxsavourezmoi.fr">https://boxsavourezmoi.fr</option>
                      <option class="yellow-text text-darken-4" value="other-url">Autre</option>
                    </select>
                    </label>
                   <div class="input-field col s12" id="base-url-custom-input">
                    <input placeholder="https://unepetitemousse.fr?duree=3" id="base-url-custom" type="url" class="validate autocomplete-base-url" >
                    <!--<label class="yellow-text text-darken-4">URL de Destination <i class="material-icons help" id="help-base-url">live_help</i></label>-->
                  </div>
                  </div>
                </div>
                <div class="row">
                    <div class="col s12">
                      <label class="yellow-text text-darken-4">Nom de la campagne <i class="material-icons help" id="help-utm-campagne">live_help</i>
                      <select class="searchable-select select2 yellow-text text-darken-4" id="utm-campagne" style="width:75%;display: block;" required>
                        <option class="yellow-text text-darken-4" value="" disabled selected>Choisissez votre campagne</option>
                        <option class="yellow-text text-darken-4" value="other-campaign">Autre</option>
                      </select>
                      </label>
                      <div class="input-field col s12" id="utm-campagne-custom-input">
                        <input placeholder="Ma nouvelle campagne" id="utm-campagne-custom" type="text" class="validate" >
                      </div>
                    </div>
                </div>
                <div class="row">
                  <div class="col s12">
                    <label class="yellow-text text-darken-4">Source de la campagne <i class="material-icons help" id="help-utm-source">live_help</i>
                    <select class="searchable-select select2 yellow-text text-darken-4" id="utm-source" style="width:75%;display: block;" required>
                      <option class="yellow-text text-darken-4" value="" disabled selected>Choisissez la source</option>
                      
                      <option class="yellow-text text-darken-4" value="other-source">Autre</option>
                    </select>
                    </label>
                    <div class="input-field col s12" id="utm-source-custom-input">
                        <input placeholder="ma-nouvelle-source" id="utm-source-custom" type="text" class="validate" >
                    </div>
                  </div>

                </div>
                <div class="row">
                  <div class="col s12">
                    <label class="yellow-text text-darken-4">Support de la campagne <i class="material-icons help" id="help-utm-support">live_help</i>
                    <select class="searchable-select select2 yellow-text text-darken-4" id="utm-support" style="width:75%;display: block;" required>
                      <option class="yellow-text text-darken-4" value="" disabled selected>Choisissez le support</option>
                      
                      <option class="yellow-text text-darken-4" value="other-support">Autre</option>
                    </select>
                    </label>
                    <div class="input-field col s12" id="utm-support-custom-input">
                        <input placeholder="mon-nouveau-support" id="utm-support-custom" type="text" class="validate" >
                    </div>
                  </div>

                </div>


                <div class="row">
                  <div class="input-field col s12">
                    <input placeholder="bonus-septembre-2018,french-days-2018," id="utm-contenu" type="text" class="validate">
                    <label class="yellow-text text-darken-4" for="utm-contenu">Contenu de la campagne <i class="material-icons help" id="help-utm-contenu">live_help</i></label>
                  </div>
                </div>
                <div class="row">
                  <div class="input-field col s12">
                    <input placeholder="janvier-2018,audience-acheteurs-box,audience-grenoblois,article,membres-unepetitemousse" id="utm-terme" type="text" class="validate">
                    <label class="yellow-text text-darken-4" for="utm-terme">Terme de la campagne <i class="material-icons help" id="help-utm-terme">live_help</i></label>
                  </div>
                </div>

                <button class="btn waves-effect yellow darken-4 waves-light" onclick="getFormElements();">Obtenir mon lien
                    <i class="material-icons left">link</i>
                </button>
                <p>&nbsp;</p>
              </form>
          <div class="col m5 grey-lighten-4">
            <strong>Un doute sur l'une des valeur à renseigner ?</strong>
            <!--Start answer for base-url-->
            <div class="answer card" id="answer-base-url">
              <div class="card-content">
                L'<span class="yellow-text text-darken-4">URL de destination</span> correspond à l'url de la page sur laquelle tu souhaites diriger les visiteurs. <br><br>
                Par exemple : <em>https://unepetitemousse.fr/</em> ou <em>https://unepetitemousse.fr/cadeau-biere</em>
                <br><br>
                Si tu as besoin d'ajouter des paramètres (?duree=3, ?coffret=mois,...), ajoutes-les dès maintenant !
              </div>
              <div class="card-action">
                <button class="btn btn-flat waves-effect waves-green" id="close-answer-base-url">Compris !</button>  
              </div>
            </div>
            <!--End answer for base-url-->
            <!--Start answer for utm-campagne-->
            <div class="answer card" id="answer-utm-campagne">
              <div class="card-content">
                Le<span class="yellow-text text-darken-4"> nom de la campagne</span> correspond à <strong>l'objectif</strong> poursuivit par la campagne. C'est donc le niveau le plus haut et le plus générique possible.<br><br>
                Par exemple : <em>box</em> ou <em>calendrier-avent</em> ou <em>boutique</em> ou encore <em>brasserie</em>
                <br><br>
                Si tu as un doute : demandes-moi :)
              </div>
              <div class="card-action">
                <button class="btn btn-flat waves-effect waves-orange" id="close-answer-utm-campagne">Compris !</button>  
              </div>
            </div>
            <!--End answer for utm-campagne-->
            <!--Start answer for utm-source-->
            <div class="answer card" id="answer-utm-source">
              <div class="card-content">
                La<span class="yellow-text text-darken-4"> source de la campagne</span> correspond à la <strong>provenance de la campagne</strong>. En d'autre terme elle correspond à "l'endroit" où tu vas déposer ton lien. Il peut s'agir du nom du site sur lequel le lien sera diffusé <br><br>
                Par exemple : <em>mon-super-blog</em>,<em>facebook</em>,<em>google</em>,<em>backend</em> ou encore <em>mautic</em>
                <br><br>
                Si tu as un doute : demandes-moi :)
              </div>
              <div class="card-action">
                <button class="btn btn-flat waves-effect waves-green" id="close-answer-utm-source">Compris !</button>  
              </div>
            </div>
            <!--End answer for utm-source-->
            <!--Start answer for utm-support-->
            <div class="answer card" id="answer-utm-support">
              <div class="card-content">
                Le<span class="yellow-text text-darken-4"> support de la campagne</span> correspond au <strong>moyen par lequel le lien est communiqué</strong> sur la <em>source</em> choisie.<br><br>
                Par exemple : <em>email</em>,<em>post</em>,<em>dark-post</em>,<em>cpc</em> ou encore <em>article</em>.
                <br><br>
                Si tu as un doute : demandes-moi :)
              </div>
              <div class="card-action">
                <button class="btn btn-flat waves-effect waves-green" id="close-answer-utm-support">Compris !</button>  
              </div>
            </div>
            <!--End answer for utm-support-->
           <!--Start answer for utm-contenu-->
           <div class="answer card" id="answer-utm-contenu">
             <div class="card-content">
               Le<span class="yellow-text text-darken-4"> contenu de la campagne</span> permet d'<strong>identifier plus précisément le message qui a été communiqué avec le lien</strong>. On s'en sert par exemple pour préciser la raison pour laquelle on contact un client par email ou pour préciser le contenu d'un post facebook. C'est un élément facultatif.<br><br>
               Par exemple : <em>complement-boutique-octobre-2018</em>,<em>concours-x-y</em>,<em>french-days-2018</em>,<em>barrel-aged-day</em>.
               <br><br>
               Si tu as un doute : demandes-moi :)
             </div>
             <div class="card-action">
               <button class="btn btn-flat waves-effect waves-green" id="close-answer-utm-contenu">Compris !</button>  
             </div>
           </div>
           <!--End answer for utm-contenu-->
            <!--Start answer for utm-terme-->
            <div class="answer card" id="answer-utm-terme">
              <div class="card-content">
                Le<span class="yellow-text text-darken-4"> terme de la campange</span> permet de <strong>différencier les éventuelles variations de la campagne</strong>. On s'en sert par exemple pour préciser l'audience ciblée, le format de publicité ou d'image utilisé, le mot-clé ciblé, le mois concerné... C'est un élément facultatif.<br><br>
                Par exemple : <em>janvier-2018</em>,<em>audience-acheteurs-box</em>,<em>audience-grenoblois</em>,<em>cpc</em>...
                <br><br>
                Si tu as un doute : demandes-moi :)
              </div>
              <div class="card-action">
                <button class="btn btn-flat waves-effect waves-green" id="close-answer-utm-terme">Compris !</button>  
              </div>
            </div>
            <!--End answer for utm-terme-->

            <p id="help-text"><em>Clique sur le point d'interrogation à côté de l'item en question pour afficher l'aide ici ;)</em></p>
          </div>
          <p>&nbsp;</p>
        </div>
        <div class="row card">
          <div class="col s12">
            <p><em>Ajouter des paramètres à un lien permet de modifier certaines informations de la page de destination ou dans certains cas, de simplement passer des informations à Google Analytics sur la provenance de l'utilisateur qui a cliqué sur le lien en question. On ajoute un paramètre à une URL en indiquant son nom (ex: "selection"), immédiatement précédé par un "?" (indiquant au navigateur que les élements suivants de l'url sont des parametres personalisés) ou un "&" si le "?" a déjà été indiqué. ON indique en suite la valeur que l'on souhaite donner au parametre ("=bieres-du-monde). Dans tous les cas, le signe "?" ne doit apparaitre qu'une seule fois dans le lien. Pour des soucis de formalisme, on privilégie les caractères minuscules, sans accents, sans caractères spécial,n en remplacant les espaces par des "-"</em></p>
          </div>
        </div>
        <div id="urlModal" class="modal">
            <div class="modal-content">
              <h4>URL à utiliser</h4>
              <p>Voici l'URL à utiliser pour ta campagne :</p>
              <div class="flow-text"><strong id="utm-to-share"></strong></div>
              <p id="success-feedback" class="alert-success"><em class="green-text">C'est good, l'URL est bien copiée dans ton presse-papier :)</em></p>
            </div>
            
            <div class="modal-footer">
              <a href="#!" id="test-url" class="modal-action modal-close waves-effect waves-green btn green lighten-1">Tester</a>
              <button class="btn btnToCopy yellow darken-4 text-white" data-clipboard-target="#utm-to-share" style="margin-left: 5px;">Copier</button>
            </div>
            <div id="gif-wrap"></div>
          </div>
      </div>
    <!-- End of content-->
    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-alpha.3/js/materialize.min.js"></script>
    <script type="text/javascript" src="https://rawgit.com/nicodeforge/clipboard.js/master/dist/clipboard.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>
    
    
    <script type="text/javascript">

      $(document).ready(function(){
          
          $('.searchable-select').select2({
            //dropdownParent: $('.input-field')
          });
         // $('select').select();
          //$('select').formSelect();
          $('.modal').modal();
          $('#success-feedback').hide();
          $('.answer').hide();
          $('.div-days-to-optimize').hide();
          $('#base-url-custom-input').hide();
          $('#utm-campagne-custom-input').hide();
          $('#utm-source-custom-input').hide();
          $('#utm-support-custom-input').hide();


          utm_campaign_options = utm_campaign_options.sort();
          $.each(utm_campaign_options, function (i, item) {
              $('#utm-campagne').append($('<option>', { 
                  value: item,
                  text : item 
              }));
          });

          utm_source_options = utm_source_options.sort();
          $.each(utm_source_options, function (i, item) {
              $('#utm-source').append($('<option>', { 
                  value: item,
                  text : item 
              }));
          });

          utm_support_options = utm_support_options.sort();
          $.each(utm_support_options, function (i, item) {
              $('#utm-support').append($('<option>', { 
                  value: item,
                  text : item 
              }));
          });


          $('#base-url').change(function() {
            //If base url is changed to "other", we display anotther free inupt

            //console.log("value changed for base url");

            if (document.forms["general"].elements["base-url"].value === "other-url") {
              $('#base-url-custom-input').toggle();
            }
            if (document.forms["general"].elements["base-url"].value != "other-url") {
              $('#base-url-custom-input').hide();
            }
            

          });

          $('#utm-campagne').change(function() {
            //If base url is changed to "other", we display anotther free inupt

            //console.log("value changed for base url");

            if (document.forms["general"].elements["utm-campagne"].value == "other-campaign") {
              $('#utm-campagne-custom-input').toggle();
            }
            if (document.forms["general"].elements["utm-campagne"].value != "other-campaign") {
             $('#utm-campagne-custom-input').hide(); 
            }
            

          });

          $('#utm-source').change(function() {
            //If base url is changed to "other", we display anotther free inupt

            //console.log("value changed for base url");

            if (document.forms["general"].elements["utm-source"].value == "other-source") {
              $('#utm-source-custom-input').toggle();
            }
            if (document.forms["general"].elements["utm-source"].value != "other-source") {
             $('#utm-source-custom-input').hide(); 
            }
            

          });


          $('#utm-support').change(function() {
            //If base url is changed to "other", we display anotther free inupt

            //console.log("value changed for base url");

            if (document.forms["general"].elements["utm-support"].value == "other-support") {
              $('#utm-support-custom-input').toggle();
            }
            if (document.forms["general"].elements["utm-support"].value != "other-support") {
             $('#utm-support-custom-input').hide(); 
            }
            

          });



          var sourceData;
            $.ajax({
              type: "GET",
              //crossDomain : true,
              headers: {  'Access-Control-Allow-Origin': 'http://nicodeforge.github.io' },
              url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZVr7Lno69w5J9QGiVij0xvTwINxgKyINd6v_bP6PXihsmm0JSOm2DZSRknzx_2SIW_beVoA32tmNF/pub?output=csv",
              content : 'text/plain',
              crossDomain : true,
              dataType: "text",       
              success: function(response)  
              {
              //data = $.csv.toArrays(response);
              //generateHtmlTable(data);
              data = $.csv.toArrays(response);
              console.log(data);
              }   
            });


        });

      function postDataToWebhook(data){
            //get the values needed from the passed in json object
            var baseUrl=data.baseUrl,
               utmCampagne=data.utmCampagne,
               utmSource=data.utmSource,
               utmSupport=data.utmSupport,
               utmContenu=data.utmContenu,
               utmTerme=data.utmTerme,
               createdAt=data.createdAt,
               urlType=data.urlType

            //url to your webhook
              webHookUrl="https://hooks.zapier.com/hooks/catch/1160774/8cqrmx/";
            
            //https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest
            var oReq = new XMLHttpRequest();
            var myJSONStr = payload={
                "baseUrl" : baseUrl,
               "utmCampagne" : utmCampagne,
               "utmSource" : utmSource,
               "utmSupport" : utmSupport,
               "utmContenu" : utmContenu,
               "utmTerme" : utmTerme,
               "createdAt" : moment().format("MMMM Do YYYY"),
               "urlType" : urlType
                };
              
            //register method called after data has been sent method is executed
              oReq.addEventListener("load", reqListener);
              oReq.open("POST", webHookUrl,true);
              oReq.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
              oReq.send(JSON.stringify(myJSONStr));
            }
            //callback method after webhook is executed
            function reqListener () {
              console.log(this.responseText);
            }

      function getFormElements(){ 
        event.preventDefault(); // Empêche le rechargement de la page et l'effacement des champs du formulaire après le clic du bouton Submit

        //Récupère tous les champs du formulaire et les stocks dans des variables
        
        var baseUrl = document.forms["general"].elements["base-url"].value, 
            utmCampagne = document.forms["general"].elements["utm-campagne"].value, 
            utmSource = document.forms["general"].elements["utm-source"].value,
            utmSupport = document.forms["general"].elements["utm-support"].value,
            utmContenu = document.forms["general"].elements["utm-contenu"].value,
            utmTerme = document.forms["general"].elements["utm-terme"].value,
            createdAt = moment(),
            urlType = "0";

            //Cas des parametres "custom"
            if (baseUrl === "other-url") {
              baseUrl = document.forms["general"].elements["base-url-custom"].value;  
            }

            if (utmCampagne === "other-campaign") {
              utmCampagne = document.forms["general"].elements["utm-campagne-custom"].value; 
            }

            if (utmSource === "other-source") {
              utmSource = document.forms["general"].elements["utm-source-custom"].value; 
            }

            if (utmSupport === "other-support") {
              utmSupport = document.forms["general"].elements["utm-support-custom"].value; 
            }

                

            //Vérifier si des paramètres ont été ajoutés à base-url
        var checkParam = "?",
            hasParam = baseUrl.includes(checkParam); //Renvoi 1 si param ajouté, 0 sinon

            //Vérifier les valeurs utmContenu & utmTerme qui ne sont pas mandatory
            if (utmContenu == '' && utmTerme == '') {
            urlType = "1";
            } else{
              if (utmContenu == '') {
                urlType="2";
              }else{
                if (utmTerme == '') {
                  urlType="3";
                }else{
                  urlType="4";
                }
              }
            }


            //Selon le type d'URL et l'ajout de parametres de base, on assemble l'url finale
            if (hasParam === false) {
              switch (urlType){
                case "1":
                var sharableUrl = baseUrl+"?utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne;
                break;
                case "2":
                var sharableUrl = baseUrl+"?utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_term="+utmTerme;
                break;
                case "3":
                var sharableUrl = baseUrl+"?utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_content="+utmContenu;
                break;
                case "4":
                var sharableUrl = baseUrl+"?utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_content="+utmContenu+"&utm_term="+utmTerme;
                break;
                default :
                var sharableUrl = baseUrl+"?utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne;
              }
            } else{

            if (hasParam === true) {
              switch (urlType){
                case "1":
                var sharableUrl = baseUrl+"&utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne;
                break;
                case "2":
                var sharableUrl = baseUrl+"&utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_term="+utmTerme;
                break;
                case "3":
                var sharableUrl = baseUrl+"&utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_content="+utmContenu;
                break;
                case "4":
                var sharableUrl = baseUrl+"&utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne+"&utm_content="+utmContenu+"&utm_term="+utmTerme;
                break;
                default :
                var sharableUrl = baseUrl+"&utm_source="+utmSource+"&utm_medium="+utmSupport+"&utm_campaign="+utmCampagne;
              }
            }

            }
        

        document.getElementById('utm-to-share').innerHTML = sharableUrl;
        
        $('#urlModal').modal('open');

        // On récupère le nom du compte à analyser
        if (baseUrl.includes("unepetitemousse")) {
          
          analysedAccount = "Une Petite Mousse";

        } else{
          if (baseUrl.includes("laboxfromage")) {
            
            analysedAccount = "La Box Fromage"
          }
        }

        data = {
          "baseUrl" : baseUrl,
          "utmCampagne" : utmCampagne,
          "utmSource" : utmSource,
          "utmSupport" : utmSupport,
          "utmContenu" : utmContenu,
          "utmTerme" : utmTerme,
          "createdAt" : createdAt,
          "urlType" : urlType
        }

      

        

      }

      //Start clipboard plugin init
        var clipboard = new Clipboard('.btnToCopy');
        clipboard.on('success', function(e) {
            $("#success-feedback").show();
            postDataToWebhook(data);
            e.clearSelection();
        });
        //End clipboard plugin init


        //Helpers
        $('#help-base-url').click(function(){
          $('.answer').hide();
          $('#answer-base-url').show();
        });
        $('#help-utm-campagne').click(function(){
          $('.answer').hide();
          $('#answer-utm-campagne').show();
        });
        $('#help-utm-source').click(function(){
          $('.answer').hide();
          $('#answer-utm-source').show();
        });
        $('#help-utm-support').click(function(){
          $('.answer').hide();
          $('#answer-utm-support').show();
        });
        $('#help-utm-contenu').click(function(){
          $('.answer').hide();
          $('#answer-utm-contenu').show();
        });
        $('#help-utm-terme').click(function(){
          $('.answer').hide();
          $('#answer-utm-terme').show();
        });
        $('#close-answer-base-url').click(function(e){
          e.preventDefault();
          $('#answer-base-url').hide();
        });
        $('#close-answer-utm-campagne').click(function(e){
          e.preventDefault();
          $('#answer-utm-campagne').hide();
        });
        $('#close-answer-utm-source').click(function(e){
          e.preventDefault();
          $('#answer-utm-source').hide();
        });
        $('#close-answer-utm-support').click(function(e){
          e.preventDefault();
          $('#answer-utm-support').hide();
        });
        $('#close-answer-utm-terme').click(function(e){
          e.preventDefault();
          $('#answer-utm-terme').hide();
        });
        $('#close-answer-utm-contenu').click(function(e){
          e.preventDefault();
          $('#answer-utm-contenu').hide();
        });

      //Autocomplete Destination URL
      $(document).ready(function(){
          $('autocomplete-base-url').autocomplete({
            data: {
              "https://unepetitemousse.fr/": null,
              "https://unepetitemousse.fr/cadeau-biere/": null,
              "https://unepetitemousse.fr/box/abonnement": null
            },
          });
        });
        
        //Tester l'URL
        $('#test-url').click(function(){
          window.open(encodeURI(document.getElementById('utm-to-share').innerText),'_blank');
        });
        

    </script>
  </body>
</html>